<div class="title">
  <h2><%= term_filter %></h2>
  <h1>Test Scores</h1>
  <%= link_for :new, new_resource %>
  <%= link_for :import, TestScore %>
  <%= link_for :fullscreen, TestScore %>
</div>
  
<div class="scroller">
  <div class="table">
    <div>
      <span class="spacer"></span>
      <span class="image"></span>
      <span>Student</span>
      <% @test_models.each do |test_model| %>
        <span class="parent" data-id="<%= test_model.id %>">
          <%= test_model.name %>
        </span>
        <% test_model.test_attributes.each do |test_attribute| %>
          <span title="<%= test_attribute.name %>" class="child" data-parent-id="<%= test_model.id %>">
            <%= test_attribute.name %>
          </span>
        <% end %>
      <% end %>
      <span class="spacer"></span>
    </div>
    <% collection.each do |student| %>
      <a href="<%= "#{request.path}/#{student.id}" %>" data-id="<%= student.id %>">
        <span class="spacer"></span>
        <span class="image"><%= image_tag student.image(:thumbnail) %></span>
        <span><%= student.last_name %>,<br /><%= student.first_name %></span>
        <% arranged_values(student.test_scores).each_with_index do |test_values, index| %>
          <span <%= @cell_attributes[index] %>>
            <% if test_values.respond_to?(:each) %>
              <ul>
              <% test_values.each do |test_value| %>
                <li class="<%= test_value.level %>" title="<%= test_value.level.titleize %>">
                  <%= test_value.name %>:
                  <i><%= test_value.value %></i>
                </li>
              <% end %>
              </ul>
            <% elsif test_values.respond_to?(:value) %>
              <i class="<%= test_values.level %>" title="<%= test_values.level.titleize %>">
                <%= test_values.value %>
              </i>
            <% else %>
              <%= none %>
            <% end %>
          </span>
        <% end %>
        <span class="spacer"></span>
      </a>
    <% end %>
  </div>
</div>